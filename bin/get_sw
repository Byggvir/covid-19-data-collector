#!/bin/bash

# This bash script collects the data from Baden-WÃ¼rttemberg (BW) und Rheinland-Pfalz (RP), DEU
#
# The trailing number /NN/ changes daily (?).
# If the number is wrong, we get an redirekt or an error 404.

DATUM=$(date +%Y%m%d%H%M)
DATADIR=$1

# New source is already in CSV-format

SOURCE=https://d.swr.de/coronavirus/corona.csv

wget --tries=2 -O "${DATADIR}/sw-${DATUM}.csv" "${SOURCE}$D"  || exit

awk -F ',' 'BEGIN {sum=0;bev=0;} NR>1 {sum+=$5;bev+=$7} END {print ("81,-,Summe,-," sum ",-," bev ",-,-,-,-,-") ;}' < ${DATADIR}/sw-${DATUM}.csv >>${DATADIR}/sw-${DATUM}.csv
